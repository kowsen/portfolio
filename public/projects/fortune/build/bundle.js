var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function a(t){return t()}function s(){return Object.create(null)}function o(t){t.forEach(a)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,...n){if(null==e)return t;const a=e.subscribe(...n);return a.unsubscribe?()=>a.unsubscribe():a}function c(t){let e;return l(t,(t=>e=t))(),e}function u(t,e,n){t.$$.on_destroy.push(l(e,n))}const h="undefined"!=typeof window;let d=h?()=>window.performance.now():()=>Date.now(),g=h?t=>requestAnimationFrame(t):t;const f=new Set;function p(t){f.forEach((e=>{e.c(t)||(f.delete(e),e.f())})),0!==f.size&&g(p)}function y(t,e){t.appendChild(e)}function m(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode.removeChild(t)}function b(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function v(t){return document.createElement(t)}function k(t){return document.createTextNode(t)}function x(){return k(" ")}function E(){return k("")}function $(t,e,n,a){return t.addEventListener(e,n,a),()=>t.removeEventListener(e,n,a)}function A(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function I(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e,n,a){t.style.setProperty(e,n,a?"important":"")}let D,_;function j(){if(void 0===D){D=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){D=!0}}return D}function L(t,e,n){t.classList[n?"add":"remove"](e)}function S(t){_=t}function T(){if(!_)throw new Error("Function called outside component initialization");return _}function R(){const t=T();return(e,n)=>{const a=t.$$.callbacks[e];if(a){const s=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);a.slice().forEach((e=>{e.call(t,s)}))}}}const M=[],P=[],N=[],C=[],Y=Promise.resolve();let H=!1;function B(t){N.push(t)}let z=!1;const U=new Set;function W(){if(!z){z=!0;do{for(let t=0;t<M.length;t+=1){const e=M[t];S(e),K(e.$$)}for(M.length=0;P.length;)P.pop()();for(let t=0;t<N.length;t+=1){const e=N[t];U.has(e)||(U.add(e),e())}N.length=0}while(M.length);for(;C.length;)C.pop()();H=!1,z=!1,U.clear()}}function K(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}const G=new Set;let F;function q(){F={r:0,c:[],p:F}}function J(){F.r||o(F.c),F=F.p}function V(t,e){t&&t.i&&(G.delete(t),t.i(e))}function Q(t,e,n,a){if(t&&t.o){if(G.has(t))return;G.add(t),F.c.push((()=>{G.delete(t),a&&(n&&t.d(1),a())})),t.o(e)}}const Z="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function X(t){t&&t.c()}function tt(t,e,n){const{fragment:s,on_mount:r,on_destroy:l,after_update:c}=t.$$;s&&s.m(e,n),B((()=>{const e=r.map(a).filter(i);l?l.push(...e):o(e),t.$$.on_mount=[]})),c.forEach(B)}function et(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function nt(t,e){-1===t.$$.dirty[0]&&(M.push(t),H||(H=!0,Y.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function at(e,n,a,i,r,l,c=[-1]){const u=_;S(e);const h=n.props||{},d=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:r,bound:s(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:s(),dirty:c};let g=!1;if(d.ctx=a?a(e,h,((t,n,...a)=>{const s=a.length?a[0]:n;return d.ctx&&r(d.ctx[t],d.ctx[t]=s)&&(d.bound[t]&&d.bound[t](s),g&&nt(e,t)),n})):[],d.update(),g=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);d.fragment&&d.fragment.l(t),t.forEach(w)}else d.fragment&&d.fragment.c();n.intro&&V(e.$$.fragment),tt(e,n.target,n.anchor),W()}S(u)}class st{$destroy(){et(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const ot={},it={},rt=[document.createElement("audio"),document.createElement("audio")];function lt(t,e){it[t]=e}rt[0].loop=!0,rt[1].loop=!0;let ct=0;const ut=[];function ht(t,e=0){"string"!=typeof t&&(t=t[Math.floor(Math.random()*t.length)]);const n=it[t];if(!n)return;let a=ot[t];a||(a=[],ot[t]=a);let s=a.find((t=>t.paused));s||n.maxInstances&&!(n.maxInstances>a.length)||(s=document.createElement("audio"),s.volume=2*n.volume||1,s.playbackRate=n.speed||1,s.src=`build/assets/sfx/${n.path}`,a.push(s)),function(t){setTimeout((()=>{null==t||t.play()}),e)}(s)}function dt(t,e,n){rt[t].src=e,rt[t].volume=2*n}function gt(t){rt[t].play()}function ft(t,e,n){rt[t].playbackRate=e,rt[t].volume=2*n}function pt(e){let n;return{c(){n=v("div"),A(n,"class","card svelte-1itn12l"),A(n,"style",e[0])},m(t,e){m(t,n,e)},p(t,[e]){1&e&&A(n,"style",t[0])},i:t,o:t,d(t){t&&w(n)}}}function yt(t,e,n){let a="",{card:s}=e;let o={x:-100,y:-100,rotation:0};return t.$set=t=>{"card"in t&&n(1,s=t.card)},t.$$.update=()=>{6&t.$$.dirty&&(n(0,a=function(t,e){let n=`background-image: url(build/assets/cards/${function(t){return`${t.value.toLocaleLowerCase()}_of_${t.suit.toLocaleLowerCase()}s.png`}(s.info)});top: ${t.y}px;left: ${t.x}px;z-index:${t.z||0}`;return 0!==t.rotation&&(n+=`;transform: rotate(${t.rotation}deg)`),e&&(n+=";filter: contrast(0%)"),n}(s.position,s.isHidden)),s.position.x===o.x&&s.position.y===o.y||ht("card"),n(2,o=s.position))},[a,s]}class mt extends st{constructor(t){super(),at(this,t,yt,pt,r,{card:1})}}function wt(e){let n;return{c(){n=v("div"),A(n,"class","chip svelte-1a89uds"),A(n,"style",e[0])},m(t,e){m(t,n,e)},p(t,[e]){1&e&&A(n,"style",t[0])},i:t,o:t,d(t){t&&w(n)}}}function bt(t,e,n){let a="",{chip:s}=e,o={x:-100,y:-100,rotation:0};return t.$set=t=>{"chip"in t&&n(1,s=t.chip)},t.$$.update=()=>{if(6&t.$$.dirty){if(n(0,a=function(t){let e=`top: ${t.y}px;left: ${t.x}px;z-index:${t.z||0}`;return 0!==t.rotation&&(e+=`;transform: rotate(${t.rotation}deg)`),e}(s.position)),s.position.x!==o.x||s.position.y!==o.y){ht(s.position.y<0?"chip-high":s.position.y>1080?"chip":"chip-low",100*Math.random())}n(2,o=s.position)}},[a,s]}class vt extends st{constructor(t){super(),at(this,t,bt,wt,r,{chip:1})}}const kt=[];function xt(e,n=t){let a;const s=[];function o(t){if(r(e,t)&&(e=t,a)){const t=!kt.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),kt.push(n,e)}if(t){for(let t=0;t<kt.length;t+=2)kt[t][0](kt[t+1]);kt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(i,r=t){const l=[i,r];return s.push(l),1===s.length&&(a=n(o)||t),i(e),()=>{const t=s.indexOf(l);-1!==t&&s.splice(t,1),0===s.length&&(a(),a=null)}}}}function Et(e,n,a){const s=!Array.isArray(e),r=s?[e]:e,c=n.length<2;return{subscribe:xt(a,(e=>{let a=!1;const u=[];let h=0,d=t;const g=()=>{if(h)return;d();const a=n(s?u[0]:u,e);c?e(a):d=i(a)?a:t},f=r.map(((t,e)=>l(t,(t=>{u[e]=t,h&=~(1<<e),a&&g()}),(()=>{h|=1<<e}))));return a=!0,g(),function(){o(f),d()}})).subscribe}}function $t(t,e=!1){return e&&(t=t.filter((t=>!t.isHidden))),At(t.map((({info:t})=>t)))}function At(t){let e=t.map((t=>It(t)[0])).reduce(((t,e)=>t+e),0);if(e>21){const n=t.filter((t=>"ACE"===t.value));for(const t of n)if(e-=10,e<=21)return e}return e}function It(t){let e=parseInt(t.value);if(isNaN(e))switch(t.value){case"ACE":e=11;break;case"JACK":case"QUEEN":case"KING":e=10}return"ACE"===t.value?[e,1]:[e]}const Ot=xt([]),Dt=xt([]),_t=xt(!1),jt=xt(!1),Lt=xt(void 0),St=[];function Tt(t,e){if(c(jt))St.push({func:t,remaining:e});else{const n={func:t,remaining:e,start:Date.now(),timeoutId:setTimeout((()=>{const e=St.indexOf(n);St.splice(e,1),t()}),e)};St.push(n)}}function Rt(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*e),a=t[e];t[e]=t[n],t[n]=a}return t}async function Mt(t){return new Promise((e=>{Tt((()=>{e()}),t)}))}function Pt(t,e){return t[t.length-1-e]}function Nt(t,e){return Pt(t,e)}function Ct(t,e){return t.map((t=>t.players[e]))}function Yt(t){return 0===Math.floor(Math.random()*t)}jt.subscribe((t=>{if(t)for(const t of St)clearTimeout(t.timeoutId),t.remaining=t.remaining-(Date.now()-t.start);else for(const t of St)t.start=Date.now(),t.timeoutId=setTimeout((()=>{const e=St.indexOf(t);St.splice(e,1),t.func()}),t.remaining)}));let Ht=0;function Bt(){return Ht+=1,Ht}const zt=[{x:332,y:516,width:300,height:450,rotation:31},{x:624,y:633,width:300,height:450,rotation:15},{x:940,y:670,width:300,height:450,rotation:0},{x:1246,y:630,width:300,height:450,rotation:-14},{x:1542,y:519,width:300,height:450,rotation:-29}],Ut=[{x:177,y:1273,width:300,height:150,rotation:31},{x:546,y:1423,width:300,height:150,rotation:15},{x:940,y:1e3,width:150,height:150,rotation:0},{x:1319,y:1426,width:300,height:150,rotation:-14},{x:1687,y:1281,width:300,height:150,rotation:-29}],Wt={x:960,y:230,width:500,height:250,rotation:0},Kt={x:960,y:-100,width:500,height:100,rotation:0},Gt={x:1700,y:180,width:200,height:200,rotation:0},Ft=[{x:60,y:750,messageDx:200,messageDy:-20},{x:490,y:880,messageDx:200,messageDy:-40},{x:-300,y:-300,messageDx:0,messageDy:0},{x:1200,y:880,messageDx:-190,messageDy:-40},{x:1630,y:750,messageDx:-190,messageDy:-20}],qt=zt.map((t=>Zt(-20,5,0,t))),Jt=[[-8,15],[-5,10],[0,8],[0,5],[10,-2]],Vt=zt.map(((t,e)=>Zt(40+Jt[e][0],170+Jt[e][1],0,t))),Qt=Zt(-20,-20,0,Wt);function Zt(t,e,n,a){const s=Math.sqrt(t*t+e*e),o=Math.atan2(e,t)+a.rotation*Math.PI/180,i=s*Math.cos(o)+a.x,r=s*Math.sin(o)+a.y,l=n+a.rotation;return{x:Math.round(i),y:Math.round(r),rotation:l}}function Xt(t,e,n){const a=Zt(t-n.x,e-n.y,0,Object.assign(Object.assign({},n),{rotation:-n.rotation}));return n.width/2>Math.abs(a.x-n.x)&&n.height/2>Math.abs(a.y-n.y)}function te(t,e){return t.cards.filter((({position:t})=>Xt(t.x,t.y,e)))}function ee(t,e){return t.chips.filter((({position:t})=>Xt(t.x,t.y,e)))}function ne(t,e){return te(t,zt[e])}function ae(t,e){return ee(t,zt[e])}function se(t,e){return ee(t,Ut[e])}function oe(t,e){const n=zt[e],a=ne(t,e).length%5;return Object.assign(Object.assign({},Zt(30*a-70,-90-30*a,0,n)),{z:Bt()})}function ie(t,e,n){const a=t=>{for(const e of n)if(Math.abs(t.x-e.position.x)<25&&Math.abs(t.y-e.position.y)<25)return!0;return!1};let s;const o=zt[e];do{s=Zt(80*Math.random()-40-20,80*Math.random()-40+125,0,o)}while(a(s));return Object.assign(Object.assign({},s),{z:Bt()})}function re(t,e){const n=Ut[e],a=n.width-42,s=n.height-42,o=Math.random()*a-a/2-20,i=Math.random()*s-s/2-20;return Object.assign(Object.assign({},Zt(o,i,0,n)),{z:Bt()})}function le(t){return te(t,Wt)}const ce=[{dx:-110,dy:-80},{dx:10,dy:-80},{dx:-80,dy:0},{dx:-50,dy:0},{dx:-20,dy:0},{dx:10,dy:0},{dx:40,dy:0}];function ue(){const t=Kt;return{x:t.x,y:t.y,z:Bt(),rotation:t.rotation}}function he(t,e){return t.chips.filter((t=>Xt(t.position.x,t.position.y,Kt))).slice(0,e)}function de(){const t=Gt;return{x:t.x,y:t.y,z:Bt(),rotation:t.rotation}}function ge(t){const e=te(t,Gt);return Rt(e.map(((t,e)=>e))).map((t=>{const n=e[t];return Object.assign(Object.assign({},n),{position:Object.assign(Object.assign({},n.position),{z:Bt()})})}))}function fe(t){return[1,2,3,4].map((e=>`${t}_${e}`))}const pe=[{name:"Ol' Monty",id:"gil",voices:["voice/male_standard_1.ogg","voice/male_standard_2.ogg","voice/male_standard_3.ogg","voice/male_standard_4.ogg"]},{name:"Doc",id:"pro",voices:["voice/female_deep_1.ogg","voice/female_deep_2.ogg","voice/female_deep_3.ogg","voice/female_deep_4.ogg"]},{name:"The Chief",id:"fame",voices:["voice/male_deep_1.ogg","voice/male_deep_2.ogg","voice/male_deep_3.ogg","voice/male_deep_4.ogg"]},{name:"Ginny",id:"drink",voices:["voice/drunk_1.ogg","voice/drunk_2.ogg","voice/drunk_3.ogg","voice/drunk_4.ogg"]},{name:"Sophia",id:"heir",voices:["voice/female_light_1.ogg","voice/female_light_2.ogg","voice/female_light_3.ogg","voice/female_light_4.ogg"]},{name:"Sherry",id:"bar",voices:["voice/female_standard_1.ogg","voice/female_standard_2.ogg","voice/female_standard_3.ogg","voice/female_standard_4.ogg"]},{name:"Liam",id:"fresh",voices:["voice/male_high_1.ogg","voice/male_high_2.ogg","voice/male_high_3.ogg","voice/male_high_4.ogg"]},{name:"Maxwell",id:"max",voices:["voice/male_higher_1.ogg","voice/male_higher_2.ogg","voice/male_higher_3.ogg","voice/male_higher_4.ogg"]}];for(const t of pe){const e=fe(t.id);for(let n=0;n<e.length;n++)lt(e[n],{path:t.voices[n],volume:.05,speed:2,maxInstances:2})}let ye=0;const me=function(t){const e=function(t){const e=[],n={};for(const[a,s,o]of t){const t=we(s,o).filter((t=>!e.includes(t))),i=t[Math.floor(Math.random()*t.length)];n[a]=i,e.push(i)}return n}([["v0",0,3],["bar",0,4],["v1",0,4],["v2",0,5],["v3",0,6]]),n=[0,1,2,3,4,5,6,7].filter((t=>{const n=Object.keys(e);for(const a of n)if(e[a]===t)return!1;return!0}));e.pro=n[Math.floor(2*Math.random())];const a=Rt(t).filter((t=>"bar"!==t.id&&"pro"!==t.id)),s=["bar","pro"].sort(((t,n)=>e[t]-e[n]));for(const n of s)a.splice(e[n],0,t.find((t=>t.id===n)));const o=["v0","v1","v2","v3"];for(let t=0;t<o.length;t++){a[e[o[t]]].villainRound=t}return a[e.bar]=Object.assign(Object.assign({},a[e.bar]),{villainRound:4}),console.log("SCHEDULED PEOPLE",a),a}([...pe]);function we(t,e){const n=[];for(let a=t;a<=e;a++)n.push(a);return n}function be(){const t=me[ye];return ye+=1,{name:t.name,image:t.id,villainRound:t.villainRound,locked:!1}}const ve=function(){const t=["ACE","2","3","4","5","6","7","8","9","10","JACK","QUEEN","KING"],e=["HEART","DIAMOND","SPADE","CLUB"],n=[];for(const a of e)for(const e of t)n.push({suit:a,value:e});return n}().map((t=>({info:t,position:de(),isHidden:!0}))),ke=[];for(let t=0;t<50;t++)ke.push({value:1,position:ue()});const xe=xt({cards:ve,chips:ke,players:function(){const t=[0,0,0,0].map((()=>be()));return t.splice(2,0,{name:"Player",locked:!1}),t}()});xe.update((t=>Object.assign(Object.assign({},t),{chips:t.chips.concat([...Array(25)].map((()=>({value:1,position:re(0,2)}))))})));const Ee=xt(0),$e=xt([{state:c(xe),isReset:!1}]);let Ae={kind:"INITIALIZE_NODE"};const Ie=Et([Ee,$e],(([t,e])=>({currentIndex:t,length:e.length,resetFrames:e.map(((t,e)=>t.isReset?e:-1)).filter((t=>-1!==t))})));function Oe(t,e){De(function(t){const e=te(t,Gt);let n=-1;for(let t=0;t<e.length;t++)e[t].position.z>n&&(n=t);return n}(c(xe)),t,!!e)}function De(t,e,n){xe.update((a=>{const s=[...a.cards];return s[t]=Object.assign(Object.assign({},s[t]),{position:e,isHidden:n}),Object.assign(Object.assign({},a),{cards:s})}))}function _e(t,e){Ye();const n=le(t);return $t(n)>=17?je(t,-1):(Oe(function(t){const e=Wt,n=le(t).length,{dx:a,dy:s}=ce[n];return Object.assign(Object.assign({},Zt(a,s,0,e)),{z:Bt()})}(t),1===n.length),1===n.length?{kind:"DECIDE_PLAYER",target:0}:n.length<1?{kind:"DEAL_PLAYER",target:0}:{kind:"DEAL_DEALER"})}function je(t,e){if(e===t.players.length-1)return{kind:"RESET_NODE"};const n=ae(t,e+1).length,a=$t(ne(t,e+1)),s=$t(le(t));return 0===a||0===n?{kind:"SKIP_PLAYER",target:e+1}:a>21?{kind:"LOSE_PLAYER",target:e+1}:s>21||a>s?{kind:"WIN_PLAYER",target:e+1,isBlackjack:!1}:s>a?{kind:"LOSE_PLAYER",target:e+1}:{kind:"PUSH_PLAYER",target:e+1}}function Le(){const t=Ae,e=c(xe);switch(Ae.kind){case"INITIALIZE_NODE":Ae={kind:"RESET_NODE"};break;case"DEAL_PLAYER":n=e,a=Ae,Ye(),ae(n,a.target).length>0&&Oe(oe(n,a.target)),Ae=21===$t(ne(c(xe),a.target))?{kind:"BLACKJACK_PLAYER",target:a.target}:a.target===n.players.length-1?{kind:"DEAL_DEALER"}:{kind:"DEAL_PLAYER",target:a.target+1};break;case"DEAL_DEALER":Ae=_e(e);break;case"RESET_NODE":Ae=function(t,e){Ye();for(let e=0;e<t.cards.length;e++)De(e,de(),!0);xe.update((t=>Object.assign(Object.assign({},t),{cards:ge(t),players:t.players.map((t=>Object.assign(Object.assign({},t),{locked:!1})))})));for(const e of[0,1,3,4]){const n=se(t,e).length;if(n<10){const t=[...Array(10-n)].map((()=>({value:1,position:re(0,e)})));xe.update((e=>Object.assign(Object.assign({},e),{chips:e.chips.concat(t)})))}}const n=he(t,50).length;if(n<50){const t=[...Array(50-n)].map((()=>({value:1,position:ue()})));xe.update((e=>Object.assign(Object.assign({},e),{chips:e.chips.concat(t)})))}return{kind:"BET_PLAYER",target:0}}(e);break;case"BET_PLAYER":Ae=function(t,e){return e.target===t.players.length-1?{kind:"DEAL_PLAYER",target:0}:{kind:"BET_PLAYER",target:e.target+1}}(e,Ae);break;case"DECIDE_PLAYER":Ae=function(t,e){Ye();const n=t.players[e.target],a=ae(t,e.target).length>0;return $t(ne(t,e.target))>21?{kind:"BUST_PLAYER",target:e.target}:n.locked||!a?e.target===t.players.length-1?{kind:"REVEAL"}:{kind:"DECIDE_PLAYER",target:e.target+1}:{kind:"DECIDE_PLAYER",target:e.target}}(e,Ae);break;case"REVEAL":Ae=function(t,e){Ye();const n=le(t);return xe.update((t=>Object.assign(Object.assign({},t),{cards:t.cards.map((t=>Object.assign(Object.assign({},t),{isHidden:!n.includes(t)&&t.isHidden})))}))),{kind:"DEAL_DEALER"}}(e);break;case"SKIP_PLAYER":Ae=function(t,e){return Ye(),je(t,e.target)}(e,Ae);break;case"PUSH_PLAYER":Ae=function(t,e){Ye();const n=ae(t,e.target);return Te((t=>n.includes(t)?Object.assign(Object.assign({},t),{position:re(0,e.target)}):t)),Ce("PUSH",e.target),je(t,e.target)}(e,Ae);break;case"WIN_PLAYER":Ae=function(t,e){Ye();const n=ae(t,e.target),a=he(t,n.length);return Te((t=>n.includes(t)||a.includes(t)?Object.assign(Object.assign({},t),{position:re(0,e.target)}):t)),Ce("WIN",e.target),je(t,e.target)}(e,Ae);break;case"LOSE_PLAYER":Ae=function(t,e){Ye();const n=ae(t,e.target);return Te((t=>n.includes(t)?Object.assign(Object.assign({},t),{position:ue()}):t)),Ce("LOSE",e.target),je(t,e.target)}(e,Ae);break;case"BUST_PLAYER":Ae=function(t,e){const n=ae(t,e.target);return Te((t=>n.includes(t)?Object.assign(Object.assign({},t),{position:ue()}):t)),Ce("BUST",e.target),e.target===t.players.length-1?{kind:"REVEAL"}:{kind:"DECIDE_PLAYER",target:e.target+1}}(e,Ae);break;case"BLACKJACK_PLAYER":Ae=function(t,e){const n=ae(t,e.target),a=he(t,2*n.length);return Te((t=>n.includes(t)||a.includes(t)?Object.assign(Object.assign({},t),{position:re(0,e.target)}):t)),xe.update((t=>Object.assign(Object.assign({},t),{players:t.players.map(((t,n)=>n===e.target?Object.assign(Object.assign({},t),{locked:!0}):t))}))),Ce("WIN",e.target),e.target===t.players.length-1?{kind:"DEAL_DEALER"}:{kind:"DEAL_PLAYER",target:e.target+1}}(e,Ae)}var n,a;const s=c(xe);return e!==s&&Se(s,"RESET_NODE"===t.kind),{lastAction:t,nextAction:Ae,startState:e,endState:s}}function Se(t,e=!1){$e.update((n=>[...n,{state:t,isReset:e}])),Ee.set(c($e).length-1)}function Te(t){xe.update((e=>Object.assign(Object.assign({},e),{chips:e.chips.map((e=>t(e)))})))}function Re(t,e,n=!1){const a=se(c(xe),e).slice(0,t),s=[];if(Te((t=>{const n=(t=>a.includes(t)?Object.assign(Object.assign({},t),{position:ie(c(xe),e,s)}):t)(t);return t!==n&&s.push(n),n})),Se(c(xe)),!n)for(const n of Ue)n(t,e)}function Me(t){const e=ae(c(xe),t).length,n=c(xe).players[t];return 0===e||n.locked?[]:e<=se(c(xe),t).length?["HIT","STAND","DOUBLE"]:["HIT","STAND"]}function Pe(t,e){"HIT"!==t&&"DOUBLE"!==t||Oe(oe(c(xe),e)),("STAND"===t||"DOUBLE"===t||$t(ne(c(xe),e))>=21)&&xe.update((t=>{const n=[...t.players];return n[e].locked=!0,Object.assign(Object.assign({},t),{players:n})})),"DOUBLE"===t?Re(ae(c(xe),e).length,e,!0):Se(c(xe));for(const n of We)n(t,e)}function Ne(t,e){if(null==t?void 0:t.light){const t=c(xe).players[e].message;if(t&&!t.light)return 0}if(xe.update((n=>Object.assign(Object.assign({},n),{players:n.players.map(((n,a)=>e===a?Object.assign(Object.assign({},n),{message:t}):n)),lastTalk:e}))),Se(c(xe)),t){return 50*t.text.split(",").join(",*****").split(".").join(".*****").length/(t.speed||1)+(t.preDelay||0)+(t.postDelay||0)}return 0}function Ce(t,e){xe.update((n=>{const a=[...n.players];return a[e]=Object.assign(Object.assign({},a[e]),{decision:t}),Object.assign(Object.assign({},n),{players:a})}))}function Ye(){for(let t=0;t<5;t++)Ce(void 0,t)}function He(t,e){Ce(t,e),Se(c(xe))}function Be(t){He(void 0,t)}function ze(t){Ee.set(t);const e=c($e)[t].state;xe.set(e)}const Ue=[];const We=[];const Ke=[];const Ge=[];function Fe(e){let n,a,s,i,r,l,c,u,h,d,g,f,p,b,E,O,D,_,j,S,T,R,M,P,N,C;return{c(){n=v("div"),a=v("div"),s=v("div"),i=v("span"),r=k("Hand: "),l=k(e[2]),c=k(" / "),u=k(e[3]),h=x(),d=v("img"),f=x(),p=v("img"),E=x(),O=v("img"),_=x(),j=v("input"),T=x(),R=v("div"),M=v("img"),A(i,"class","svelte-6lpez2"),A(s,"class","hand svelte-6lpez2"),A(d,"class","play svelte-6lpez2"),A(d,"alt","resume"),d.src!==(g="build/assets/play.png")&&A(d,"src","build/assets/play.png"),A(p,"class","back svelte-6lpez2"),A(p,"alt","back"),p.src!==(b="build/assets/back.png")&&A(p,"src","build/assets/back.png"),A(O,"class","forward svelte-6lpez2"),A(O,"alt","forward"),O.src!==(D="build/assets/forward.png")&&A(O,"src","build/assets/forward.png"),A(j,"type","range"),A(j,"min",e[0]),A(j,"max",e[1]),A(j,"step","1"),j.value=S=e[4].currentIndex,A(j,"class","svelte-6lpez2"),A(a,"class","control-container svelte-6lpez2"),L(a,"hidden-control",!e[5]),A(M,"class","pause svelte-6lpez2"),A(M,"alt","pause"),M.src!==(P="build/assets/pause.png")&&A(M,"src","build/assets/pause.png"),A(R,"class","control-container svelte-6lpez2"),L(R,"hidden-control",e[5]),A(n,"class","timeline svelte-6lpez2")},m(t,o){m(t,n,o),y(n,a),y(a,s),y(s,i),y(i,r),y(i,l),y(i,c),y(i,u),y(a,h),y(a,d),y(a,f),y(a,p),y(a,E),y(a,O),y(a,_),y(a,j),y(n,T),y(n,R),y(R,M),N||(C=[$(d,"click",e[8]),$(p,"click",e[9]),$(O,"click",e[10]),$(j,"input",e[6]),$(M,"click",e[7])],N=!0)},p(t,[e]){4&e&&I(l,t[2]),8&e&&I(u,t[3]),1&e&&A(j,"min",t[0]),2&e&&A(j,"max",t[1]),16&e&&S!==(S=t[4].currentIndex)&&(j.value=S),32&e&&L(a,"hidden-control",!t[5]),32&e&&L(R,"hidden-control",t[5])},i:t,o:t,d(t){t&&w(n),N=!1,o(C)}}}function qe(t,e,n){let a,s;u(t,Ie,(t=>n(4,a=t))),u(t,jt,(t=>n(5,s=t)));const o=R();let i,r,l,c,h,d;let g=!0;function f(t){g=!1,setTimeout((()=>{g=!0}),t)}return f(3e3),t.$$.update=()=>{if(17&t.$$.dirty){n(0,i=0),n(1,r=a.length-1);const t=a.resetFrames;for(let e=0;e<t.length;e++){const s=t[e];s<=a.currentIndex&&(n(0,i=s),l=Math.max(i-1,1),n(2,h=e+1))}for(let e=t.length-1;e>=0;e--){const s=t[e];s>a.currentIndex&&(n(1,r=s-1),c=t[e+1]?t[e+1]-1:a.length-1)}n(3,d=t.length)}},[i,r,h,d,a,s,function({target:t}){o("change",{value:t.value})},function(){g&&(o("pause"),f(1e3))},function(){g&&(o("resume"),f(1e3))},function(){o("change",{value:l})},function(){o("change",{value:c})}]}class Je extends st{constructor(t){super(),at(this,t,qe,Fe,r,{})}}function Ve(t){return"[object Date]"===Object.prototype.toString.call(t)}function Qe(t,e){if(t===e||t!=t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map(((e,n)=>Qe(t[n],e)));return t=>n.map((e=>e(t)))}if("object"===n){if(!t||!e)throw new Error("Object cannot be null");if(Ve(t)&&Ve(e)){t=t.getTime();const n=(e=e.getTime())-t;return e=>new Date(t+e*n)}const n=Object.keys(e),a={};return n.forEach((n=>{a[n]=Qe(t[n],e[n])})),t=>{const e={};return n.forEach((n=>{e[n]=a[n](t)})),e}}if("number"===n){const n=e-t;return e=>t+e*n}throw new Error(`Cannot interpolate ${n} values`)}function Ze(t,a={}){const s=xt(t);let o,i=t;function r(r,l){if(null==t)return s.set(t=r),Promise.resolve();i=r;let c=o,u=!1,{delay:h=0,duration:y=400,easing:m=e,interpolate:w=Qe}=n(n({},a),l);if(0===y)return c&&(c.abort(),c=null),s.set(t=i),Promise.resolve();const b=d()+h;let v;return o=function(t){let e;return 0===f.size&&g(p),{promise:new Promise((n=>{f.add(e={c:t,f:n})})),abort(){f.delete(e)}}}((e=>{if(e<b)return!0;u||(v=w(t,r),"function"==typeof y&&(y=y(t,r)),u=!0),c&&(c.abort(),c=null);const n=e-b;return n>y?(s.set(t=r),!1):(s.set(t=v(m(n/y))),!0)})),o.promise}return{set:r,update:(e,n)=>r(e(i,t),n),subscribe:s.subscribe}}function Xe(e){let n,a,s,o,i,r,l,c,u,h,d,g,f=(e[0]?.text||"")+"";return{c(){n=v("div"),a=v("div"),s=v("span"),o=k(e[3]),i=v("span"),r=k(e[4]),l=x(),c=v("div"),u=v("div"),h=v("span"),d=k(f),A(i,"class","spacing svelte-1tf8bb"),A(a,"class","message-text-container svelte-1tf8bb"),A(n,"class","message svelte-1tf8bb"),O(n,"height",Math.max(e[1]-10,0)+"px"),O(n,"opacity",e[0]?.9:0),O(n,"transition","all ease "+(e[2]?.2:.5)+"s"),L(n,"light",e[0]?.light),A(u,"class","message-text-container svelte-1tf8bb"),A(c,"class","message measure svelte-1tf8bb"),B((()=>e[10].call(c))),L(c,"light",e[0]?.light)},m(t,f){m(t,n,f),y(n,a),y(a,s),y(s,o),y(a,i),y(i,r),m(t,l,f),m(t,c,f),y(c,u),y(u,h),y(h,d),g=function(t,e){const n=getComputedStyle(t),a=(parseInt(n.zIndex)||0)-1;"static"===n.position&&(t.style.position="relative");const s=v("iframe");s.setAttribute("style",`display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: ${a};`),s.setAttribute("aria-hidden","true"),s.tabIndex=-1;const o=j();let i;return o?(s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=$(window,"message",(t=>{t.source===s.contentWindow&&e()}))):(s.src="about:blank",s.onload=()=>{i=$(s.contentWindow,"resize",e)}),y(t,s),()=>{(o||i&&s.contentWindow)&&i(),w(s)}}(c,e[10].bind(c))},p(t,[e]){8&e&&I(o,t[3]),16&e&&I(r,t[4]),2&e&&O(n,"height",Math.max(t[1]-10,0)+"px"),1&e&&O(n,"opacity",t[0]?.9:0),4&e&&O(n,"transition","all ease "+(t[2]?.2:.5)+"s"),1&e&&L(n,"light",t[0]?.light),1&e&&f!==(f=(t[0]?.text||"")+"")&&I(d,f),1&e&&L(c,"light",t[0]?.light)},i:t,o:t,d(t){t&&w(n),t&&w(l),t&&w(c),g()}}}function tn(t){return(t||"").split(",").join(",*****").split(".").join(".*****")}function en(t,e,n){let a,s,o,i,r;u(t,jt,(t=>n(2,a=t)));const l=R();let{message:c}=e,{voice:h}=e,d=-1;const g=xt((null==c?void 0:c.text)||"");let f,p;u(t,g,(t=>n(17,o=t)));const y=Ze(0,{delay:0,duration:(t,e)=>e<1||a?0:50*(e-t)/((null==c?void 0:c.speed)||1)});u(t,y,(t=>n(16,s=t)));const m=jt.subscribe((t=>{if(t)n(12,f=c),n(13,p=s),y.set(p);else if(c===f){const t=tn((null==c?void 0:c.text)||"");y.set(t?t.length:0)}}));let w=0;const b=y.subscribe((t=>{var e;(t=Math.ceil(t))%2==0&&t>w&&h&&(e=d,ut.includes(e))&&ht(fe(h)),w=t})),v=Et([g,y],(([t,e])=>t?t.substring(0,Math.ceil(e)).split("*").join(""):""));u(t,v,(t=>n(3,i=t)));const k=Et([g,v],(([t,e])=>t!==tn(e))).subscribe((t=>{c&&(l("playing",{isPlaying:t}),t||function(t){const e=ut.indexOf(t);-1!==e&&ut.splice(e,1)}(d))})),x=Et([g,y],(([t,e])=>t?t.substring(Math.ceil(e),t.length).split("*").join(""):""));u(t,x,(t=>n(4,r=t)));let E,$=0;var A;return A=()=>{k(),b(),m()},T().$$.on_destroy.push(A),t.$set=t=>{"message"in t&&n(0,c=t.message),"voice"in t&&n(9,h=t.voice)},t.$$.update=()=>{if(176133&t.$$.dirty){const t=tn((null==c?void 0:c.text)||"");if(o!==t){(null==c?void 0:c.text)&&!(null==c?void 0:c.light)&&(d=function(){const t=ct;return ct+=1,ut.push(t),ut.length>2&&ut.shift(),t}()),c===f?y.set(p,{duration:0}):y.set(0),g.set(t),clearTimeout(E);const e=a?0:void 0===(null==c?void 0:c.preDelay)?500:c.preDelay;n(15,E=setTimeout((()=>{const e=a&&c===f?p:t?t.length:0;y.set(e)}),e))}}},[c,$,a,i,r,g,y,v,x,h,function(){$=this.offsetHeight,n(1,$)}]}class nn extends st{constructor(t){super(),at(this,t,en,Xe,r,{message:0,voice:9})}}function an(t){let e;return{c(){e=v("div"),A(e,"class","decision svelte-1drxspn"),O(e,"background-image","url('"+t[0]+"')"),O(e,"opacity",t[1])},m(t,n){m(t,e,n)},p(t,n){1&n&&O(e,"background-image","url('"+t[0]+"')"),2&n&&O(e,"opacity",t[1])},d(t){t&&w(e)}}}function sn(e){let n,a=e[0]&&an(e);return{c(){a&&a.c(),n=E()},m(t,e){a&&a.m(t,e),m(t,n,e)},p(t,[e]){t[0]?a?a.p(t,e):(a=an(t),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i:t,o:t,d(t){a&&a.d(t),t&&w(n)}}}function on(t,e,n){let a;const s={HIT:"build/assets/hit.png",STAND:"build/assets/stand.png",DOUBLE:"build/assets/double.png",WIN:"build/assets/win.png",LOSE:"build/assets/lose.png",BUST:"build/assets/bust.png",PUSH:"build/assets/push.png"};let o,{decision:i}=e;const r=Ze(0,{duration:200});return u(t,r,(t=>n(1,a=t))),t.$set=t=>{"decision"in t&&n(3,i=t.decision)},t.$$.update=()=>{if(8&t.$$.dirty){const t=s[i];t?(n(0,o=t),r.set(1)):r.set(0)}},[o,a,r,i]}class rn extends st{constructor(t){super(),at(this,t,on,sn,r,{decision:3})}}function ln(t){let e;return{c(){e=v("div"),A(e,"class","profile-image svelte-1aveyss"),A(e,"style",t[2])},m(t,n){m(t,e,n)},p(t,n){4&n&&A(e,"style",t[2])},d(t){t&&w(e)}}}function cn(t){let e,n,a,s,o,i,r,l,c,u,h,d=t[4]?.image&&ln(t);return i=new rn({props:{decision:t[4]?.decision}}),u=new nn({props:{message:t[5],voice:t[4]?.image}}),u.$on("playing",t[9]),{c(){e=v("div"),d&&d.c(),n=x(),a=v("div"),s=x(),o=v("div"),X(i.$$.fragment),r=x(),l=x(),c=v("div"),X(u.$$.fragment),A(a,"class","profile-frame svelte-1aveyss"),A(a,"style",t[3]),A(o,"class","profile-overlay svelte-1aveyss"),A(e,"class","profile svelte-1aveyss"),A(e,"style",t[0]),A(c,"class","message-container svelte-1aveyss"),A(c,"style",t[1])},m(t,g){m(t,e,g),d&&d.m(e,null),y(e,n),y(e,a),y(e,s),y(e,o),tt(i,o,null),y(o,r),m(t,l,g),m(t,c,g),tt(u,c,null),h=!0},p(t,[s]){t[4]?.image?d?d.p(t,s):(d=ln(t),d.c(),d.m(e,n)):d&&(d.d(1),d=null),(!h||8&s)&&A(a,"style",t[3]);const o={};16&s&&(o.decision=t[4]?.decision),i.$set(o),(!h||1&s)&&A(e,"style",t[0]);const r={};32&s&&(r.message=t[5]),16&s&&(r.voice=t[4]?.image),u.$set(r),(!h||2&s)&&A(c,"style",t[1])},i(t){h||(V(i.$$.fragment,t),V(u.$$.fragment,t),h=!0)},o(t){Q(i.$$.fragment,t),Q(u.$$.fragment,t),h=!1},d(t){t&&w(e),d&&d.d(),et(i),t&&w(l),t&&w(c),et(u)}}}function un(t,e,n){let a,s,o,i;u(t,jt,(t=>n(12,s=t)));const r=R();let{profile:l}=e,{index:c}=e;const h=xt(c),d=Et([xe,h],(([t,e])=>t.players[c]));u(t,d,(t=>n(4,a=t)));const g=Et(d,(t=>t.message));u(t,g,(t=>n(5,o=t)));let f="",p="",y="",m="",w=Ze(0,{duration:(t,e)=>0===e?0:1e5}),b=Et(w,(t=>{const e="drink"===(null==a?void 0:a.image)?1500:850,n="drink"===(null==a?void 0:a.image)?30:15,s=t%e/e;return s<.25?2*s*n:s<.75?2*(s-.25)*-n+n/2:2*(s-.75)*n-n/2}));return u(t,b,(t=>n(13,i=t))),t.$set=t=>{"profile"in t&&n(10,l=t.profile),"index"in t&&n(11,c=t.index)},t.$$.update=()=>{11312&t.$$.dirty&&(h.set(c),n(0,f=`left: ${l.x}px;top: ${l.y}px;opacity: ${o?.9:.6};transform: rotate(${i}deg)`),n(1,p=`left: ${l.x+l.messageDx}px;top: ${l.y+l.messageDy}px`),n(2,y=`background-image: url('build/assets/portraits/${null==a?void 0:a.image}.png')`),n(3,m=`filter: brightness(${o?o.light?50:100:0}%)`),o||w.set(0))},[f,p,y,m,a,o,d,g,b,function(t){if(s)return;const e=t.detail.isPlaying;Tt((()=>{s||((null==o?void 0:o.light)||w.set(e?1e5:0),e||Ne(void 0,c),r("playing",{isPlaying:e}))}),e?0:void 0===(null==o?void 0:o.postDelay)?2500:o.postDelay)},l,c]}class hn extends st{constructor(t){super(),at(this,t,un,cn,r,{profile:10,index:11})}}function dn(t,e,n){const a=t.slice();return a[8]=e[n],a}function gn(t,e,n){const a=t.slice();return a[11]=e[n],a}function fn(t){let e,n,a,s,o=t[0].length>0&&pn(t),i=t[1].length>0&&mn(t);return{c(){e=v("div"),n=v("div"),a=x(),o&&o.c(),s=x(),i&&i.c(),A(n,"class","decide-bkg svelte-29697m"),A(e,"class","decide svelte-29697m")},m(t,r){m(t,e,r),y(e,n),y(e,a),o&&o.m(e,null),y(e,s),i&&i.m(e,null)},p(t,n){t[0].length>0?o?o.p(t,n):(o=pn(t),o.c(),o.m(e,s)):o&&(o.d(1),o=null),t[1].length>0?i?i.p(t,n):(i=mn(t),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(t){t&&w(e),o&&o.d(),i&&i.d()}}}function pn(t){let e,n=t[0],a=[];for(let e=0;e<n.length;e+=1)a[e]=yn(gn(t,n,e));return{c(){e=v("div");for(let t=0;t<a.length;t+=1)a[t].c();A(e,"class","decide-contents svelte-29697m")},m(t,n){m(t,e,n);for(let t=0;t<a.length;t+=1)a[t].m(e,null)},p(t,s){if(5&s){let o;for(n=t[0],o=0;o<n.length;o+=1){const i=gn(t,n,o);a[o]?a[o].p(i,s):(a[o]=yn(i),a[o].c(),a[o].m(e,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=n.length}},d(t){t&&w(e),b(a,t)}}}function yn(t){let e,n,a,s,o=t[11]+"";function i(...e){return t[4](t[11],...e)}return{c(){e=v("button"),n=k(o),A(e,"class","svelte-29697m")},m(t,o){m(t,e,o),y(e,n),a||(s=$(e,"click",i),a=!0)},p(e,a){t=e,1&a&&o!==(o=t[11]+"")&&I(n,o)},d(t){t&&w(e),a=!1,s()}}}function mn(t){let e,n,a,s,o,i=t[1],r=[];for(let e=0;e<i.length;e+=1)r[e]=wn(dn(t,i,e));return{c(){e=v("div"),n=v("button"),n.textContent="Sit Out",a=x();for(let t=0;t<r.length;t+=1)r[t].c();A(n,"class","svelte-29697m"),A(e,"class","bets-contents svelte-29697m")},m(i,l){m(i,e,l),y(e,n),y(e,a);for(let t=0;t<r.length;t+=1)r[t].m(e,null);s||(o=$(n,"click",t[5]),s=!0)},p(t,n){if(10&n){let a;for(i=t[1],a=0;a<i.length;a+=1){const s=dn(t,i,a);r[a]?r[a].p(s,n):(r[a]=wn(s),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=i.length}},d(t){t&&w(e),b(r,t),s=!1,o()}}}function wn(t){let e,n,a,s,o=t[8]+"";function i(...e){return t[6](t[8],...e)}return{c(){e=v("button"),n=k(o),A(e,"class","svelte-29697m")},m(t,o){m(t,e,o),y(e,n),a||(s=$(e,"click",i),a=!0)},p(e,a){t=e,2&a&&o!==(o=t[8]+"")&&I(n,o)},d(t){t&&w(e),a=!1,s()}}}function bn(e){let n,a=(e[0].length>0||e[1].length>0)&&fn(e);return{c(){a&&a.c(),n=E()},m(t,e){a&&a.m(t,e),m(t,n,e)},p(t,[e]){t[0].length>0||t[1].length>0?a?a.p(t,e):(a=fn(t),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i:t,o:t,d(t){a&&a.d(t),t&&w(n)}}}function vn(t,e,n){let a,s;u(t,Dt,(t=>n(0,a=t))),u(t,Ot,(t=>n(1,s=t)));const o=R();function i(t){o("choose",{value:t})}function r(t){o("bet",{value:t})}return[a,s,i,r,(t,e)=>i(t),t=>r(0),(t,e)=>r(t)]}class kn extends st{constructor(t){super(),at(this,t,vn,bn,r,{})}}function xn(t){let e,n;return{c(){e=v("div"),n=k(t[0]),A(e,"class","count svelte-75h3bj"),A(e,"style",t[1])},m(t,a){m(t,e,a),y(e,n)},p(t,a){1&a&&I(n,t[0]),2&a&&A(e,"style",t[1])},d(t){t&&w(e)}}}function En(e){let n,a=e[0]>0&&xn(e);return{c(){a&&a.c(),n=E()},m(t,e){a&&a.m(t,e),m(t,n,e)},p(t,[e]){t[0]>0?a?a.p(t,e):(a=xn(t),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i:t,o:t,d(t){a&&a.d(t),t&&w(n)}}}function $n(t,e,n){let a,{count:s}=e,{position:o}=e;return t.$set=t=>{"count"in t&&n(0,s=t.count),"position"in t&&n(2,o=t.position)},t.$$.update=()=>{4&t.$$.dirty&&n(1,a=o?`left: ${o.x}px;top: ${o.y}px;transform: rotate(${o.rotation}deg)`:"")},[s,a,o]}class An extends st{constructor(t){super(),at(this,t,$n,En,r,{count:0,position:2})}}const In=["Alrighty, here's what I know about the person who's after you:","","- If you bet last hand, they will always bet that amount the next hand."],On=[In,["Good work, here's the next one:","","- If their last hand won and they're below it, they'll always hit.","(Press the pause button if you need help remembering)"],["Nice going, here's another:","","- If their hand's value matches a winning hand from last round, they'll always stand."],["We're getting close, stay in there:","","- If their hand is lower than the last person to start talking's most recent winning hand, they'll always hit."],["Ok, last one:","","- They're in some serious debt to the Crimson Chip."],[""]],Dn=["Looks like we got the wrong one, I did all I could but they're coming for you.","","Sorry kid, that's just how it goes sometimes."],_n=xt(In),jn=xt(!1);function Ln(t,e,n){const a=t.slice();return a[4]=e[n],a}function Sn(t){let e,n,a=t[4]+"";return{c(){e=v("div"),n=k(a),A(e,"class","line svelte-13s41ch")},m(t,a){m(t,e,a),y(e,n)},p(t,e){4&e&&a!==(a=t[4]+"")&&I(n,a)},d(t){t&&w(e)}}}function Tn(t){let e,n;return{c(){e=v("img"),A(e,"class","corner svelte-13s41ch"),e.src!==(n="build/assets/corner.png")&&A(e,"src","build/assets/corner.png"),A(e,"alt","corner"),L(e,"corner-rotate",!t[1])},m(t,n){m(t,e,n)},p(t,n){2&n&&L(e,"corner-rotate",!t[1])},d(t){t&&w(e)}}}function Rn(e){let n,a,s,o,i,r,l,c=e[2],u=[];for(let t=0;t<c.length;t+=1)u[t]=Sn(Ln(e,c,t));let h=!e[0]&&Tn(e);return{c(){n=v("div"),a=v("div"),s=x(),o=v("div");for(let t=0;t<u.length;t+=1)u[t].c();i=x(),h&&h.c(),A(a,"class","clues-background svelte-13s41ch"),A(o,"class","clues-container svelte-13s41ch"),A(n,"class","clues svelte-13s41ch"),L(n,"hidden",e[1]&&!e[0])},m(t,c){m(t,n,c),y(n,a),y(n,s),y(n,o);for(let t=0;t<u.length;t+=1)u[t].m(o,null);y(n,i),h&&h.m(n,null),r||(l=$(n,"click",e[3]),r=!0)},p(t,[e]){if(4&e){let n;for(c=t[2],n=0;n<c.length;n+=1){const a=Ln(t,c,n);u[n]?u[n].p(a,e):(u[n]=Sn(a),u[n].c(),u[n].m(o,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=c.length}t[0]?h&&(h.d(1),h=null):h?h.p(t,e):(h=Tn(t),h.c(),h.m(n,null)),3&e&&L(n,"hidden",t[1]&&!t[0])},i:t,o:t,d(t){t&&w(n),b(u,t),h&&h.d(),r=!1,l()}}}function Mn(t,e,n){let a,s,o;return u(t,jt,(t=>n(0,a=t))),u(t,jn,(t=>n(1,s=t))),u(t,_n,(t=>n(2,o=t))),[a,s,o,function(){a||jn.update((t=>!t))}]}class Pn extends st{constructor(t){super(),at(this,t,Mn,Rn,r,{})}}function Nn(e){let n,a;return{c(){n=v("div"),a=k(e[0]),A(n,"class","table-text svelte-1f0goxr"),A(n,"style",e[1])},m(t,e){m(t,n,e),y(n,a)},p(t,[e]){1&e&&I(a,t[0]),2&e&&A(n,"style",t[1])},i:t,o:t,d(t){t&&w(n)}}}function Cn(t,e,n){let a,{count:s}=e,{position:o}=e;return t.$set=t=>{"count"in t&&n(0,s=t.count),"position"in t&&n(2,o=t.position)},t.$$.update=()=>{4&t.$$.dirty&&n(1,a=o?`left: ${o.x}px;top: ${o.y}px;transform: rotate(${o.rotation}deg)`:"")},[s,a,o]}class Yn extends st{constructor(t){super(),at(this,t,Cn,Nn,r,{count:0,position:2})}}class Hn{constructor(t,e=[],n=[]){this.nodes=t,this.participants=e,this.lightParticipants=n}async run(t,e){for(const n of this.nodes){const a=await n(t,e);if(void 0===a)throw new Error("MISSED A PATH");if(a)return this.nodes=a.next,{finished:0===this.nodes.length,consumedStep:a.consumedStep}}}}const Bn={gil:async(t,e)=>{const n=Pt(Ct(t,e),1);if(n){if("WIN"===(null==n?void 0:n.status)){if(Yt(2)){const t=Ne({text:"Looks like Ol' Monty's finally on a hot streak!",light:!0,speed:2.5,postDelay:250},e);await Mt(t)}return 5}if(Yt(2)){const t=Ne({text:"Ol' Monty's gotta tighten the purse a bit...",light:!0,speed:2.5,postDelay:200},e);await Mt(t)}return 1}return 1},pro:async(t,e)=>3,fame:async(t,e)=>5,drink:async(t,e)=>{const n=Pt(Ct(t,e),1);if(n){if("WIN"===(null==n?void 0:n.status))return Yt(3)&&(Ne({text:"lets keep this train rolling!",light:!0,speed:2,postDelay:250},e),await Mt(500)),n.doubled?n.bet/2:n.bet;if(Yt(3)){const t=Ne({text:"these cards think they're better than me, huh? ill show them",light:!0,speed:2,postDelay:200},e);await Mt(t)}return 5}return 5},heir:async(t,e)=>4,bar:async(t,e)=>2,fresh:async(t,e)=>Math.floor(4*Math.random())+1,max:async(t,e)=>{if(0===e)return 2*Math.floor(2*Math.random())+1;{const n=Pt(Ct(t,e-1),0).bet,a=(n-1+2)%5+1;if(Yt(5)){const t=Ne({text:`Hah, betting ${n} with a count like this? Amateurs.`,light:!0,speed:2,postDelay:200},e);await Mt(t-100)}return a}}},zn=async(t,e)=>{if("BET_PLAYER"===t.lastAction.kind&&Nt(e,0).players[t.lastAction.target].id){const n=Nt(e,0).players[t.lastAction.target].id;return Re(await Bn[n](e,t.lastAction.target),t.lastAction.target),await Mt(1e3),{next:[zn],consumedStep:!0}}return null},Un=new Hn([zn]);function Wn(t,e,n){return e?18===t&&n<7||19===t&&6===n?"DOUBLE":t>18||18===t&&n<9?"STAND":5===n||6===n||4===n&&t>14||3===n&&17===t?"DOUBLE":"HIT":t>16||t>12&&n<7||12===t&&n>3&&n<7?"STAND":11===t||10===t&&n<10||9===t&&n>2&&n<7?"DOUBLE":"HIT"}const Kn={gil:async(t,e,n)=>{const a=At(Pt(Ct(e,n),0).hand);return a<12?"HIT":13===a?(Ne({text:"Ol' Monty's can't be having any unlucky numbers hanging around...",light:!0,speed:2.5,postDelay:200},n),await Mt(500),"HIT"):a>16?"STAND":Math.random()>.5?"HIT":"STAND"},pro:async(t,e,n)=>{const a=Pt(Ct(e,n),0).hand;return Wn(At(a),!!a.find((t=>"ACE"===t.value))&&a.length<3,It(Pt(e,0).dealer.hand[1])[0])},fame:async(t,e,n)=>{const a=Pt(Ct(e,n),0).hand,s=At(a),o=Wn(s,!!a.find((t=>"ACE"===t.value))&&a.length<3,It(Pt(e,0).dealer.hand[1])[0]);return s>14&&Yt(4)?(Ne({text:"You know what? I'm feeling lucky.",light:!0,speed:2.5,postDelay:200},n),await Mt(500),"DOUBLE"):o},drink:async(t,e,n)=>{const a=t[Math.floor(Math.random()*t.length)];return Yt(5)&&(Ne({text:`ahhhh what i wasnt paying attention i guess ill ${a.toLocaleLowerCase()}`,light:!0,speed:2,postDelay:200},n),await Mt(500)),a},heir:async(t,e,n)=>{const a=At(Pt(Ct(e,n),0).hand);if(Yt(5)){const e=t[Math.floor(Math.random()*t.length)],a=Ne({text:`Oh dear, I'm not quite sure how this works... I suppose I'll ${e.toLocaleLowerCase()}`,light:!0,speed:2.5,postDelay:200},n);return await Mt(a),e}return a<11?"HIT":11===a?"DOUBLE":a<15&&Math.random()<.25?"HIT":"STAND"},bar:async(t,e,n)=>{const a=Pt(Ct(e,n),0).hand,s=At(a),o=!!a.find((t=>"ACE"===t.value))&&a.length<3,i=It(Pt(e,0).dealer.hand[1])[0];return Math.random()<.5?Wn(s,o,i):Wn(s-1,o,i)},fresh:async(t,e,n)=>{const a=Pt(Ct(e,n),0).hand;return Wn(At(a),!!a.find((t=>"ACE"===t.value))&&a.length<3,It(Pt(e,0).dealer.hand[0])[0])},max:async(t,e,n)=>{const a=At(Pt(Ct(e,n),0).hand),s=It(Pt(e,0).dealer.hand[1])[0];return a<s+7?"HIT":s<7&&a<12?(Yt(2)&&(Ne({text:"Time to rake in that cash, suckers.",light:!0,speed:2,postDelay:250},n),await Mt(500)),"DOUBLE"):"STAND"}},Gn=async(t,e)=>{if("DECIDE_PLAYER"===t.lastAction.kind){const n=Me(t.lastAction.target);if(n.length>0){const a=Nt(e,0).players[t.lastAction.target].id,s=await Kn[a](n,e,t.lastAction.target);He(s,t.lastAction.target);const o=t.lastAction.target;return await Mt(500),Be(o),Pe(s,o),{next:[Gn],consumedStep:!0}}}return null},Fn=new Hn([Gn]);let qn=0;const Jn=async(t,e)=>{if("DEAL_PLAYER"===t.lastAction.kind){const n=1===Nt(e,0).players.reduce(((t,e)=>[...t,...e.hand]),[]).length,a=function(t){const e=Nt(t,0);if(0===(null==e?void 0:e.players[2].bet)){const e=Nt(t,1);if(e){const t=e.players[2].bet-1;if(t<5&&t>=0&&2!==t)return t}}return-1}(e);if(n&&-1!==a){const e=t.endState.players[a].villainRound;return e===qn?(_n.set(On[e+1]),jn.set(!1),qn+=1):(_n.set(Dn),jn.set(!1),qn=-1),{next:[Jn],consumedStep:!1}}}else if("RESET_NODE"===t.lastAction.kind){const t=Nt(e,1),n=null==t?void 0:t.players.findIndex(((t,e)=>!t.id&&2!==e));if("number"==typeof n&&-1!==n)return await async function(t){!function(t,e){xe.update((n=>{const a=[...n.players];return a[e]=Object.assign({},t),Object.assign(Object.assign({},n),{players:a})}));const n=he(c(xe),8);xe.update((t=>Object.assign(Object.assign({},t),{chips:t.chips.map((t=>-1!==n.indexOf(t)?Object.assign(Object.assign({},t),{position:re(0,e)}):t))}))),Se(c(xe));for(const n of Ke)n(t,e)}(be(),t);const e=Ne({text:"Hiya everyone!"},t);await Mt(e+2e3)}(n),{next:[Jn],consumedStep:!1};if(0===(null==t?void 0:t.players[2].bet)){const t=Nt(e,2);if(t){const e=t.players[2].bet-1;if(e<5&&e>=0&&2!==e)return await async function(t){const e=Ne({text:"Hey, what's the big idea?"},t);await Mt(e-500),function(t){xe.update((e=>{const n=[...e.players];return n[t]=Object.assign(Object.assign({},n[t]),{name:"EMPTY",image:void 0}),Object.assign(Object.assign({},e),{players:n})})),Se(c(xe));for(const e of Ge)e(t)}(t),await Mt(2e3)}(e),5===qn?Tt((()=>{Lt.set("WIN")}),2e3):-1===qn&&Tt((()=>{Lt.set("LOSE")}),2e3),{next:[Jn],consumedStep:!1}}}}return null},Vn=new Hn([Jn]);const Qn=async(t,e)=>{const n=t.endState.players.findIndex((t=>0===t.villainRound&&!!t.image));if("BET_PLAYER"===t.lastAction.kind&&t.lastAction.target===n){const n=Pt(Ct(e,2),1);if(n){return Re(n.doubled?n.bet/2:n.bet,t.lastAction.target),await Mt(1e3),{next:[Qn],consumedStep:!0}}}return null},Zn=new Hn([Qn]),Xn=async(t,e)=>{const n=t.endState.players.findIndex((t=>1===t.villainRound&&!!t.image));if("DECIDE_PLAYER"===t.lastAction.kind&&t.lastAction.target===n){if(0===Me(t.lastAction.target).length)return null;const n=Pt(Ct(e,t.lastAction.target),1),a=Pt(Ct(e,t.lastAction.target),0);if("WIN"===(null==n?void 0:n.status)&&At(a.hand)<At(n.hand)){He("HIT",t.lastAction.target);const e=t.lastAction.target;return await Mt(500),Be(e),Pe("HIT",e),{next:[Xn],consumedStep:!0}}}return null},ta=new Hn([Xn]),ea=async(t,e)=>{const n=t.endState.players.findIndex((t=>2===t.villainRound&&!!t.image)),a=Pt(e,1);if(a&&"DECIDE_PLAYER"===t.lastAction.kind&&t.lastAction.target===n){const n=a.players.filter((t=>"WIN"===t.status)).map((({hand:t})=>At(t))),s=At(Pt(Ct(e,t.lastAction.target),0).hand);if(n.includes(s)){const e=t.lastAction.target;return He("STAND",e),await Mt(500),Be(e),Pe("STAND",e),{next:[ea],consumedStep:!0}}}return null},na=new Hn([ea]),aa=async(t,e)=>{var n;const a=t.endState.players.findIndex((t=>3===t.villainRound&&!!t.image));if("DECIDE_PLAYER"===t.lastAction.kind&&t.lastAction.target===a){const a=t.endState.lastTalk,s=null===(n=(void 0===a?[]:Ct(e,a)).reverse().find((t=>"WIN"===t.status)))||void 0===n?void 0:n.hand;if(s){const n=At(s);if(At(Pt(Ct(e,t.lastAction.target),0).hand)<n){const e=t.lastAction.target;return He("HIT",e),await Mt(500),Be(e),Pe("HIT",e),{next:[aa],consumedStep:!0}}}}return null},sa=new Hn([aa]);async function oa(t,e,n,a=0){if(-1===n[e])return;"string"==typeof t&&(t={text:t,speed:"drink"===e?.7:1,postDelay:1e3});const s=Ne(t,n[e]),o=t.light?a:s+a;await Mt(o)}const ia=[{characters:["bar","pro"],run:async t=>{await oa("Sherry.","pro",t,800),await oa("Doc.","bar",t,800),await oa("Good to have some company that isn't embarassing.","pro",t,800),await oa({text:"I heard that.",speed:2,light:!0,postDelay:250},"max",t),await oa("Couldn't agree more.","bar",t,800)}},{characters:["bar","pro"],run:async t=>{await oa("Hey Sher, about earlier...","pro",t,800),await oa("Forget I said anything, it's no big deal.","bar",t,800),await oa("I'm happy to help out.","pro",t,800),await oa({text:"come on hon dont be proud",speed:2,light:!0,postDelay:250},"drink",t),await oa("Forget it.","bar",t,800),await oa("... alright.","pro",t,800)}},{characters:["bar","pro"],run:async t=>{await oa("Had good luck lately Doc?","bar",t,800),await oa("You know how I feel about luck","pro",t),await oa({text:"Here we go again.",speed:2,light:!0,postDelay:250},"max",t),await Mt(800),await oa("You're not gonna have any if you keep not believing in it.","bar",t,800),await oa("Can't have it if it isn't real","pro",t,800),await oa("Sure.","bar",t,800)}},{characters:["bar","pro"],run:async t=>{await oa("Don't you get bored, playing like you're a robot?","bar",t,800),await oa("Winning's more fun than losing.","pro",t,800),await oa("Is it? Even if you win all the time?","bar",t,800),await oa("Especially when you win all the time.","pro",t,800),await oa("Guess I wouldn't know.","bar",t,800)}}],ra=[{characters:["fresh","fame"],run:async t=>{await oa("Oh my goodness, is that...","fresh",t),await oa({text:"Oh wow",speed:2,light:!0,postDelay:250},"max",t),await Mt(800),await oa("Shhh pal, I'm just looking for a quiet day off.","fame",t,800),await oa("But you're The Chief on NCSIS New City!","fresh",t,800),await oa("I know pal, but right now I'd just like to be Carl.","fame",t),await oa({text:"yeah carl sure you do",speed:2,light:!0,postDelay:250},"drink",t),await Mt(800)}},{characters:["fresh","fame"],run:async t=>{await oa("Hey pal, I'm sorry if I brushed you off.","fame",t,800),await oa("OH DON'T MENTION IT IT'S NO BIG DEAL","fresh",t,800),await oa("... you alright?","fame",t),await oa("Sorry, I'm just a really big fan.","fresh",t),await oa({text:"How embarassing.",speed:2,light:!0,postDelay:250},"max",t),await Mt(1e3),await oa("You don't say.","fame",t)}},{characters:["fresh","fame"],run:async t=>{await oa("Hey Mr. Chief, can I ask you something I've always wanted to ask?","fresh",t,800),await oa("Sure pal, shoot.","fame",t),await oa({text:"In episode 61, when you told your assistant that you were going to go ...",speed:1.5,postDelay:0},"fresh",t),await oa({text:"... and then you stole that forklift, was your plan to take it to ...",speed:2,preDelay:0,postDelay:0},"fresh",t),await oa({text:"... and then you caught him. Does that sound right?",speed:1,preDelay:0,postDelay:250},"fresh",t,1e3),await oa("... yeah, you got it.","fame",t),await oa("Ok great, I figured that's what happened but I just had to know.","fresh",t,800)}}],la=[{characters:["fresh","pro"],run:async t=>{await oa("This game is more complicated than I thought","fresh",t,800),await oa("It's not that tough kiddo, keep an eye on me and you'll do alright","pro",t),await oa({text:"Ha, sure you will.",speed:2,light:!0,postDelay:250},"max",t,800),await oa("Are you sure you know what you're doing?","fresh",t,800),await oa("I've been playing here since your parents were in diapers, kid.","pro",t,1e3),await oa("Point taken.","fresh",t,800)}},{characters:["fresh","pro"],run:async t=>{await oa("First lesson kid, it's all in the numbers. There's always a right way to play.","pro",t,800),await oa("But I've seen you lose before.","fresh",t,800),await oa("Nobody wins every hand, you just gotta win more than you lose.","pro",t),await oa({text:"Classic loser talk.",speed:2,light:!0,postDelay:250},"max",t,800),await oa("This is stressful.","fresh",t,800),await oa("I know, isn't it fun?","pro",t,800)}},{characters:["fresh","pro"],run:async t=>{await oa("Second lesson, play with your head.","pro",t,800),await oa("What else would I play with?","fresh",t,800),await oa("Plenty of other parts of your body make decisions. Don't let them.","pro",t),await oa({text:"Where's the fun in that?",speed:2,light:!0,postDelay:250},"fame",t,800),await oa("But my head isn't having much fun.","fresh",t,800),await oa("If you wanna play with your heart and lose, anyone here can teach you.","pro",t,800),await oa("I already have plenty of experience with that.","fresh",t,800)}}],ca=[{characters:["gil","bar"],run:async t=>{await oa("Been a rough week for Ol' Monty but things're lookin up!","gil",t),await oa({text:"That's the spirit!",speed:2,light:!0,postDelay:250},"heir",t,800),await oa("I'd pay good money for your optimism.","bar",t,800),await oa("How much?","gil",t,800),await oa("Not enough, money's been tight lately.","bar",t,800),await oa("Ol' Monty ain't one to overcharge.","gil",t,800)}},{characters:["gil","bar"],run:async t=>{await oa("So Monty, where are you staying these days?","bar",t,800),await oa("Oh, Ol' Monty's been staying here and there.","gil",t,800),await oa("... so you're homeless?","bar",t,800),await oa("Home is where the heart is!","gil",t,800),await oa("Oh dear.","bar",t,800)}},{characters:["gil","bar"],run:async t=>{await oa("Any chance Ol' Monty could get a drink on the house?","gil",t,800),await oa("Sorry, they've been cracking down on that lately.","bar",t,800),await oa("I can't afford to lose this job right now.","bar",t,800),await oa("Oh no worries, Ol' Monty doesn't want to be a bother.","gil",t,800)}}],ua=[{characters:["gil","max"],run:async t=>{await oa("Ol' Monty doesn't know when to hold them or when to fold them.","gil",t),await oa({text:"That's not... ah whatever.",speed:2,light:!0,postDelay:250},"pro",t,800),await oa("Don't worry old timer, just follow my lead.","max",t,800),await oa("Oh joy, looks like Ol' Monty's luck's finally turning around!","gil",t,800),await oa("Mark my words, with me here you'll never lose.","max",t,800)}},{characters:["gil","max"],run:async t=>{await oa("You're using your head too much old timer, you've got to use your gut","max",t),await oa({text:"Oh god.",speed:2,light:!0,postDelay:250},"pro",t,800),await oa("Ol' Monty's gut ain't what it used to be. Ask anyone.","gil",t,800),await oa("No not like that. Like your instincts - follow your heart.","max",t,800),await oa("Ol' Monty's heart ain't what it used to be either. Ask anyone.","gil",t,800)}},{characters:["gil","max"],run:async t=>{await oa("Why don't you want Ol' Monty using his head?","gil",t,800),await oa("People who use their heads are lying to you.","max",t),await oa({text:"What?",speed:2,light:!0,postDelay:250},"pro",t,800),await oa('They always say they know "statistics" but I\'ve seen them lose sometimes.',"max",t,800),await oa("Well Ol' Monty supposes that makes sense.","gil",t,800)}}],ha=[{characters:["max","pro"],run:async t=>{await oa("I can't believe some of these decisions you're all making.","max",t,800),await oa("Come on Max, let's not do this.","pro",t,800),await oa("What? I'm just saying what I'm thinking.","max",t),await oa({text:"What else is new.",speed:2,light:!0,postDelay:250},"bar",t,800),await oa("Yeah, that's the problem.","pro",t,800)}},{characters:["max","pro"],run:async t=>{await oa('So, how\'s your "system" working out, Max?',"pro",t),await oa({text:"Quit it Doc, he's not worth it.",speed:2,light:!0,postDelay:250},"bar",t,800),await oa("It's going great, thanks for asking. Already won $100 today.","max",t,800),await oa("Well that'll make a decent dent in your losses from yesterday.","pro",t,800),await oa("I'm not about living in the past, I'm about looking at the future.","max",t,800),await oa("If my present was like yours, I'd probably be the same way.","pro",t,800)}},{characters:["max","pro"],run:async t=>{await oa("You're such a selfish player, always taking everyone else's tens.","max",t),await oa({text:"Seriously Max, cut it out.",speed:2,light:!0,postDelay:250},"bar",t,800),await oa("That's literally not a thing that's possible.","pro",t,800),await oa("Classic Doc, always thinking with your head.","max",t,800),await oa("I know, what an old fool I am.","pro",t,800)}}],da=[{characters:["drink","heir"],run:async t=>{await oa("hey hon you're a precious little thing arent ya","drink",t,800),await oa("Why thank you... miss.","heir",t,800),await oa("you know i looked a lot like that five years ago","drink",t,1e3),await oa("... five years?","heir",t),await oa("I mean, I certainly hope to be as distinguished as you in that time ma'am.","heir",t),await oa({text:"Nice save.",speed:2,light:!0,postDelay:250},"fame",t,800),await oa("heh","drink",t,800)}},{characters:["drink","heir"],run:async t=>{await oa("I must say, I was nervous at first but this town is delightful.","heir",t,800),await oa("thats how it is at first kiddo but dont trust it","drink",t),await oa({text:"Don't let her spook you.",speed:2,light:!0,postDelay:250},"bar",t,800),await oa("Oh dear, what did it do to you?","heir",t,800),await oa("what do you mean im fine","drink",t,800),await oa("Oh I just thought because you said not to trust it that...","heir",t,1200),await oa("I am so sorry.","heir",t,800),await oa("heh","drink",t,800)}}],ga=[{characters:["drink","fame"],run:async t=>{await oa("hey carl hows it goin","drink",t,800),await oa("I'm sorry, have we met?","fame",t,800),await oa("nice try darling","drink",t,800),await oa("Truly I'm sorry, but I'm not sure what you're talking about.","fame",t,800),await oa("you can fool them but you cant fool me","drink",t,800)}},{characters:["drink","fame"],run:async t=>{await oa("This reminds me of a party we had on my costar's yacht.","fame",t),await oa({text:"Oh, do tell. I love a good yacht party.",speed:2,light:!0,postDelay:250},"heir",t,800),await oa("always with the yachts and the costars and the famous","drink",t,800),await oa({text:"Come on Gin, knock it off.",speed:2,light:!0,postDelay:250},"fame",t),await oa("oh look its mister too important to call saying how important he is","drink",t),await oa("I guess it doesn't really remind me of that anymore.","fame",t)}}],fa=[{characters:["bar","drink"],run:async t=>{await oa("Hey Gin, how are things at the bar?","bar",t,800),await oa("oh you know same old same old","drink",t,800),await oa("where you been?","drink",t,800),await oa("I've had to take care of stuff, should be back behind the bar soon.","bar",t,800),await oa("i hope so the new guy doesnt get my jokes","drink",t,800)}}],pa=[{characters:["fresh","heir"],run:async t=>{await oa("I apologize, I'm such a mess today.","heir",t,800),await oa("I don't think you're a mess, you're beautiful.","fresh",t,800),await oa("Oh well I know that, I meant a mess at playing.","heir",t,800),await oa("Oh of course, that's what I meant.","fresh",t,800),await oa("The playing was beautiful.","fresh",t,800),await oa("That's what I was saying when I said that.","fresh",t),await oa({text:"very smooth",speed:2,light:!0,postDelay:250},"drink",t)}}];let ya=!1,ma=1;class wa{constructor(t){this.phases=t,this.index=0}canRun(t){const e=this.getNextPhase();if(!e)return!1;for(const n of e.characters)if(!t.players.find((t=>t.id===n)))return!1;return!0}async run(t){ya=!0,await this.getNextPhase().run(function(t){const e={gil:-1,pro:-1,fame:-1,drink:-1,heir:-1,bar:-1,fresh:-1,max:-1};for(let n=0;n<t.players.length;n++)e[t.players[n].id]=n;return e}(t)),this.index+=1,ya=!1}getNextPhase(){return this.phases[this.index]}}const ba=[];const va=async(t,e)=>{if(ma>=e.length||Math.random()<.91)return null;const n=function(t){if(ya||0===t.length)return;const e=ba.filter((e=>e.canRun(Pt(t,0))));return 0!==e.length?e[Math.floor(Math.random()*e.length)]:void 0}(e);return n?(ma=Math.random()<.5?e.length:e.length+1,n.run(Pt(e,0)),{next:[va],consumedStep:!1}):null},ka=[ia,ra,la,ca,ua,ha,da,ga,fa,pa];for(const t of ka)ba.push(new wa(t));const xa=new Hn([va]),Ea=new class{constructor(){this.stories=[]}addStory(t){this.stories.push(t)}numRunning(){return this.stories.length}getParticipants(){const t={gil:0,pro:0,fame:0,drink:0,heir:0,bar:0,fresh:0,max:0};for(const e of this.stories)for(const n of e.participants)t[n]=(t[n]||0)+1;return t}async run(t,e){const n=[];for(const a of this.stories){const s=await a.run(t,e);if((null==s?void 0:s.finished)&&n.push(a),null==s?void 0:s.consumedStep)break}for(const t of n){const e=this.stories.indexOf(t);-1!==e&&this.stories.splice(e,1)}}};async function $a(t,e){return await Ea.run(t,e),function(t){switch(t.lastAction.kind){case"DEAL_PLAYER":return ne(t.endState,t.lastAction.target).length>0?250:0;case"DEAL_DEALER":return 500;case"BET_PLAYER":return ae(t.endState,t.lastAction.target).length>0?500:0;case"DECIDE_PLAYER":return ne(t.endState,t.lastAction.target).length>0?500:0;case"REVEAL":return 1e3;case"PUSH_PLAYER":case"WIN_PLAYER":case"LOSE_PLAYER":case"BUST_PLAYER":case"BLACKJACK_PLAYER":return 1e3}return 0}(t)}Ea.addStory(Zn),Ea.addStory(ta),Ea.addStory(na),Ea.addStory(sa),Ea.addStory(xa),Ea.addStory(Un),Ea.addStory(Fn),Ea.addStory(Vn);const Aa=[];function Ia(t){const e=Aa[Aa.length-1],n={players:e.players.map((t=>Object.assign(Object.assign({},t),{hand:[...t.hand]}))),dealer:Object.assign(Object.assign({},e.dealer),{hand:[...e.dealer.hand]})};t(n),Aa[Aa.length-1]=n}var Oa;async function Da(t,e,n){if(function({lastAction:t,endState:e}){"INITIALIZE_NODE"!==t.kind&&("RESET_NODE"===t.kind&&Aa.push({players:e.players.map((t=>({id:t.image||"player",hand:[],bet:0,doubled:!1}))),dealer:{hand:[],revealed:!1}}),Ia((n=>{"REVEAL"===t.kind&&(n.dealer.revealed=!0);const a=function(t){switch(t.kind){case"BUST_PLAYER":return{status:"BUST",target:t.target};case"LOSE_PLAYER":return{status:"LOSE",target:t.target};case"WIN_PLAYER":case"BLACKJACK_PLAYER":return{status:"WIN",target:t.target};case"PUSH_PLAYER":return{status:"PUSH",target:t.target}}}(t);a&&(n.players[a.target].status=a.status);for(const{message:t}of e.players)if((null==t?void 0:t.target)&&(null==t?void 0:t.source)){const e=n.players.find((e=>e.id===t.target));e&&(e.lastTalkFrom=t.source)}const s=[0,1,2,3,4].map((t=>ne(e,t).map((t=>t.info)))),o=le(e).map((t=>t.info));le(e).find((t=>t.isHidden)),n.dealer.hand=o;for(let t=0;t<s.length;t++)n.players[t].hand=s[t]})))}(t),!n){const n=await $a(t,Aa);"number"==typeof n&&Tt((()=>{e()}),n)}}function _a(t,e,n){const a=t.slice();return a[18]=e[n],a[20]=n,a}function ja(t,e,n){const a=t.slice();return a[21]=e[n],a[20]=n,a}function La(t,e,n){const a=t.slice();return a[23]=e[n],a[20]=n,a}function Sa(t,e,n){const a=t.slice();return a[25]=e[n],a}function Ta(t,e,n){const a=t.slice();return a[28]=e[n],a}function Ra(t){let e,n;return e=new mt({props:{card:t[28]}}),{c(){X(e.$$.fragment)},m(t,a){tt(e,t,a),n=!0},p(t,n){const a={};4&n&&(a.card=t[28]),e.$set(a)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){et(e,t)}}}function Ma(t){let e,n;return e=new vt({props:{chip:t[25]}}),{c(){X(e.$$.fragment)},m(t,a){tt(e,t,a),n=!0},p(t,n){const a={};4&n&&(a.chip=t[25]),e.$set(a)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){et(e,t)}}}function Pa(e){let n,a;return n=new hn({props:{profile:e[23],index:e[20]}}),{c(){X(n.$$.fragment)},m(t,e){tt(n,t,e),a=!0},p:t,i(t){a||(V(n.$$.fragment,t),a=!0)},o(t){Q(n.$$.fragment,t),a=!1},d(t){et(n,t)}}}function Na(e){let n,a;return n=new kn({}),n.$on("choose",e[7]),n.$on("bet",e[8]),{c(){X(n.$$.fragment)},m(t,e){tt(n,t,e),a=!0},p:t,i(t){a||(V(n.$$.fragment,t),a=!0)},o(t){Q(n.$$.fragment,t),a=!1},d(t){et(n,t)}}}function Ca(t){let e,n;return e=new An({props:{count:t[21],position:qt[t[20]]}}),{c(){X(e.$$.fragment)},m(t,a){tt(e,t,a),n=!0},p(t,n){const a={};2&n&&(a.count=t[21]),e.$set(a)},i(t){n||(V(e.$$.fragment,t),n=!0)},o(t){Q(e.$$.fragment,t),n=!1},d(t){et(e,t)}}}function Ya(e){let n,a;return n=new Yn({props:{count:e[20]+1,position:e[18]}}),{c(){X(n.$$.fragment)},m(t,e){tt(n,t,e),a=!0},p:t,i(t){a||(V(n.$$.fragment,t),a=!0)},o(t){Q(n.$$.fragment,t),a=!1},d(t){et(n,t)}}}function Ha(t){let e,n,a,s,o,i,r,l,c,u,h,d,g,f,p,k=t[2].cards,E=[];for(let e=0;e<k.length;e+=1)E[e]=Ra(Ta(t,k,e));const $=t=>Q(E[t],1,1,(()=>{E[t]=null}));let I=t[2].chips,D=[];for(let e=0;e<I.length;e+=1)D[e]=Ma(Sa(t,I,e));const _=t=>Q(D[t],1,1,(()=>{D[t]=null}));let j=Ft,L=[];for(let e=0;e<j.length;e+=1)L[e]=Pa(La(t,j,e));const S=t=>Q(L[t],1,1,(()=>{L[t]=null}));let T=!t[5]&&t[6]&&Na(t),R=t[1],M=[];for(let e=0;e<R.length;e+=1)M[e]=Ca(ja(t,R,e));const P=t=>Q(M[t],1,1,(()=>{M[t]=null}));let N=Vt,C=[];for(let e=0;e<N.length;e+=1)C[e]=Ya(_a(t,N,e));const Y=t=>Q(C[t],1,1,(()=>{C[t]=null}));return u=new An({props:{count:t[3],position:Qt}}),d=new Je({}),d.$on("pause",t[9]),d.$on("resume",t[10]),d.$on("change",t[11]),f=new Pn({}),{c(){e=v("div"),n=v("div"),a=x();for(let t=0;t<E.length;t+=1)E[t].c();s=x();for(let t=0;t<D.length;t+=1)D[t].c();o=x();for(let t=0;t<L.length;t+=1)L[t].c();i=x(),T&&T.c(),r=x();for(let t=0;t<M.length;t+=1)M[t].c();l=x();for(let t=0;t<C.length;t+=1)C[t].c();c=x(),X(u.$$.fragment),h=x(),X(d.$$.fragment),g=x(),X(f.$$.fragment),A(n,"class","table-background svelte-6qww3g"),A(n,"style",t[4]),A(e,"class","game-container svelte-6qww3g"),O(e,"opacity",t[0])},m(t,w){m(t,e,w),y(e,n),y(e,a);for(let t=0;t<E.length;t+=1)E[t].m(e,null);y(e,s);for(let t=0;t<D.length;t+=1)D[t].m(e,null);y(e,o);for(let t=0;t<L.length;t+=1)L[t].m(e,null);y(e,i),T&&T.m(e,null),y(e,r);for(let t=0;t<M.length;t+=1)M[t].m(e,null);y(e,l);for(let t=0;t<C.length;t+=1)C[t].m(e,null);y(e,c),tt(u,e,null),y(e,h),tt(d,e,null),y(e,g),tt(f,e,null),p=!0},p(t,[a]){if((!p||16&a)&&A(n,"style",t[4]),4&a){let n;for(k=t[2].cards,n=0;n<k.length;n+=1){const o=Ta(t,k,n);E[n]?(E[n].p(o,a),V(E[n],1)):(E[n]=Ra(o),E[n].c(),V(E[n],1),E[n].m(e,s))}for(q(),n=k.length;n<E.length;n+=1)$(n);J()}if(4&a){let n;for(I=t[2].chips,n=0;n<I.length;n+=1){const s=Sa(t,I,n);D[n]?(D[n].p(s,a),V(D[n],1)):(D[n]=Ma(s),D[n].c(),V(D[n],1),D[n].m(e,o))}for(q(),n=I.length;n<D.length;n+=1)_(n);J()}if(0&a){let n;for(j=Ft,n=0;n<j.length;n+=1){const s=La(t,j,n);L[n]?(L[n].p(s,a),V(L[n],1)):(L[n]=Pa(s),L[n].c(),V(L[n],1),L[n].m(e,i))}for(q(),n=j.length;n<L.length;n+=1)S(n);J()}if(!t[5]&&t[6]?T?(T.p(t,a),96&a&&V(T,1)):(T=Na(t),T.c(),V(T,1),T.m(e,r)):T&&(q(),Q(T,1,1,(()=>{T=null})),J()),2&a){let n;for(R=t[1],n=0;n<R.length;n+=1){const s=ja(t,R,n);M[n]?(M[n].p(s,a),V(M[n],1)):(M[n]=Ca(s),M[n].c(),V(M[n],1),M[n].m(e,l))}for(q(),n=R.length;n<M.length;n+=1)P(n);J()}if(0&a){let n;for(N=Vt,n=0;n<N.length;n+=1){const s=_a(t,N,n);C[n]?(C[n].p(s,a),V(C[n],1)):(C[n]=Ya(s),C[n].c(),V(C[n],1),C[n].m(e,c))}for(q(),n=N.length;n<C.length;n+=1)Y(n);J()}const h={};8&a&&(h.count=t[3]),u.$set(h),(!p||1&a)&&O(e,"opacity",t[0])},i(t){if(!p){for(let t=0;t<k.length;t+=1)V(E[t]);for(let t=0;t<I.length;t+=1)V(D[t]);for(let t=0;t<j.length;t+=1)V(L[t]);V(T);for(let t=0;t<R.length;t+=1)V(M[t]);for(let t=0;t<N.length;t+=1)V(C[t]);V(u.$$.fragment,t),V(d.$$.fragment,t),V(f.$$.fragment,t),p=!0}},o(t){E=E.filter(Boolean);for(let t=0;t<E.length;t+=1)Q(E[t]);D=D.filter(Boolean);for(let t=0;t<D.length;t+=1)Q(D[t]);L=L.filter(Boolean);for(let t=0;t<L.length;t+=1)Q(L[t]);Q(T),M=M.filter(Boolean);for(let t=0;t<M.length;t+=1)Q(M[t]);C=C.filter(Boolean);for(let t=0;t<C.length;t+=1)Q(C[t]);Q(u.$$.fragment,t),Q(d.$$.fragment,t),Q(f.$$.fragment,t),p=!1},d(t){t&&w(e),b(E,t),b(D,t),b(L,t),T&&T.d(),b(M,t),b(C,t),et(u),et(d),et(f)}}}function Ba(t,e,n){let a,s,o;u(t,xe,(t=>n(2,a=t))),u(t,jt,(t=>n(5,s=t))),u(t,_t,(t=>n(6,o=t)));let i,r,l,h=0;function d(t){setTimeout((()=>g()),t)}function g(){if(s)return;const t=Le();"RESET_NODE"===t.lastAction.kind&&(lt("card",{path:"cardSlide3.wav",volume:.2,maxInstances:5}),lt("chip",{path:"chipsStack3.wav",volume:.2,maxInstances:10}),lt("chip-low",{path:"chipsStack4.wav",volume:.2,maxInstances:10}),lt("chip-high",{path:"chipsHandle4.wav",volume:.2,maxInstances:10}),lt("interact",{path:"chipLay3.wav",volume:.2,maxInstances:1}));let e=!1;if("BET_PLAYER"===t.lastAction.kind&&2===t.lastAction.target){const n=[];for(let e=1;e<=Math.min(se(t.endState,2).length,5);e++)n.push(e);Ot.set(n),_t.set(!0),e=!0}if("DECIDE_PLAYER"===t.lastAction.kind&&2===t.lastAction.target){const n=Me(t.lastAction.target);n.length>0&&(Dt.set(n),_t.set(!0),e=!0)}"RESET_NODE"===t.lastAction.kind&&se(t.endState,2).length<=0&&Lt.set("LOSE_MONEY"),Da(t,(()=>{g()}),e)}return setTimeout((()=>{g()}),2e3),lt("pause",{path:"pause.ogg",volume:.5,maxInstances:1}),lt("play",{path:"play.ogg",volume:.5,maxInstances:1}),dt(0,"build/assets/mus/synth.ogg",.05),dt(1,"build/assets/mus/ambient.mp3",.02),gt(0),gt(1),setTimeout((()=>{n(0,h=1)}),500),t.$$.update=()=>{4&t.$$.dirty&&n(1,i=[0,1,2,3,4].map((t=>$t(ne(a,t))))),4&t.$$.dirty&&n(3,r=$t(le(a),!0)),32&t.$$.dirty&&n(4,l=s?"filter: grayscale(100%) brightness(0.8)":"")},[h,i,a,r,l,s,o,function(t){"STAND"===t.detail.value&&ht("interact"),_t.set(!1),Pe(t.detail.value,2),Dt.set([]),d(500)},function(t){0===t.detail.value&&ht("interact"),_t.set(!1),Re(t.detail.value,2),Ot.set([]),d(500)},function(){ht("pause"),ft(0,.5,.025),ft(1,.5,.015),jt.set(!0)},function(){ht("play"),jt.set(!1),ze(c($e).length-1),setTimeout((()=>{ft(0,1,.05),ft(1,1,.02)}),500)},function(t){ze(t.detail.value)}]}Oa=(t,e)=>{Ia((n=>{n.players[e].bet=t}))},Ue.push(Oa),function(t){We.push(t)}(((t,e)=>{"DOUBLE"===t&&Ia((t=>{t.players[e].doubled=!0,t.players[e].bet*=2}))})),function(t){Ke.push(t)}(((t,e)=>{Ia((n=>{n.players[e].id=t.image}))})),function(t){Ge.push(t)}((t=>{Ia((e=>{e.players[t].id=void 0}))}));class za extends st{constructor(t){super(),at(this,t,Ba,Ha,r,{})}}const{window:Ua}=Z;function Wa(e){let n,a,s;return{c(){n=v("div"),n.innerHTML='<p class="svelte-1kbguj">Ouch, looks like you ran out of money and got jumped.</p> \n\t\t\t<p class="svelte-1kbguj"></p> \n\t\t\t<p class="svelte-1kbguj">Click anywhere to try again...</p>',A(n,"class","title svelte-1kbguj")},m(t,e){m(t,n,e),a||(s=$(n,"click",Va),a=!0)},p:t,i:t,o:t,d(t){t&&w(n),a=!1,s()}}}function Ka(e){let n,a,s;return{c(){n=v("div"),n.innerHTML='<p class="svelte-1kbguj">Ouch, looks like you pointed out the wrong person and got jumped.</p> \n\t\t\t<p class="svelte-1kbguj"></p> \n\t\t\t<p class="svelte-1kbguj">Click anywhere to try again...</p>',A(n,"class","title svelte-1kbguj")},m(t,e){m(t,n,e),a||(s=$(n,"click",Va),a=!0)},p:t,i:t,o:t,d(t){t&&w(n),a=!1,s()}}}function Ga(e){let n,a,s,o,i,r,l,c,u,h,d,g,f=se(e[7],2).length+"";return{c(){n=v("div"),a=v("p"),a.textContent="You win!!!",s=x(),o=v("p"),i=k("Score "),r=k(f),l=x(),c=v("p"),c.textContent="",u=x(),h=v("p"),h.textContent="",d=x(),g=v("p"),g.textContent="Sorry, I'll put more effort into this screen later...",A(a,"class","svelte-1kbguj"),A(o,"class","svelte-1kbguj"),A(c,"class","svelte-1kbguj"),A(h,"class","svelte-1kbguj"),A(g,"class","svelte-1kbguj"),A(n,"class","title svelte-1kbguj")},m(t,e){m(t,n,e),y(n,a),y(n,s),y(n,o),y(o,i),y(o,r),y(n,l),y(n,c),y(n,u),y(n,h),y(n,d),y(n,g)},p(t,e){128&e&&f!==(f=se(t[7],2).length+"")&&I(r,f)},i:t,o:t,d(t){t&&w(n)}}}function Fa(e){let n,a,s;return{c(){n=v("div"),n.innerHTML='<p class="svelte-1kbguj">Hey, it looks like we&#39;re gonna need each other&#39;s help if we wanna get through today, so listen up.</p> \n\t\t\t<p class="svelte-1kbguj">There&#39;s five people in this casino that have it out for us, and they&#39;ll all make their way to this blackjack table some time soon.</p> \n\t\t\t<p class="svelte-1kbguj">If you can figure out who they are, place a bet with a number of chips that matches their space at the table and then sit out the next hand. I can handle it from there.</p> \n\t\t\t<p class="svelte-1kbguj">I&#39;ll feed you the info you need to find them as I get it. Be careful though, if you&#39;re too stingy or run out of money before finding them they&#39;ll be on you before I can do much to help.</p> \n\t\t\t<p class="svelte-1kbguj">Good luck!</p> \n\t\t\t<p class="svelte-1kbguj"></p> \n\t\t\t<p class="svelte-1kbguj">Click anywhere to start...</p>',A(n,"class","title svelte-1kbguj")},m(t,o){m(t,n,o),a||(s=$(n,"click",e[8]),a=!0)},p:t,i:t,o:t,d(t){t&&w(n),a=!1,s()}}}function qa(e){let n,a;return n=new za({}),{c(){X(n.$$.fragment)},m(t,e){tt(n,t,e),a=!0},p:t,i(t){a||(V(n.$$.fragment,t),a=!0)},o(t){Q(n.$$.fragment,t),a=!1},d(t){et(n,t)}}}function Ja(t){let e,n,a,s,o,i;B(t[9]);const r=[qa,Fa,Ga,Ka,Wa],l=[];function c(t,e){return t[0]&&!t[6]?0:t[0]?"WIN"===t[6]?2:"LOSE"===t[6]?3:"LOSE_MONEY"===t[6]?4:-1:1}return~(n=c(t))&&(a=l[n]=r[n](t)),{c(){e=v("div"),a&&a.c(),A(e,"class","game-window svelte-1kbguj"),O(e,"--scale",t[3]),O(e,"--left",t[4]),O(e,"--top",t[5])},m(a,r){m(a,e,r),~n&&l[n].m(e,null),s=!0,o||(i=$(Ua,"resize",t[9]),o=!0)},p(t,[o]){let i=n;n=c(t),n===i?~n&&l[n].p(t,o):(a&&(q(),Q(l[i],1,1,(()=>{l[i]=null})),J()),~n?(a=l[n],a||(a=l[n]=r[n](t),a.c()),V(a,1),a.m(e,null)):a=null),(!s||8&o)&&O(e,"--scale",t[3]),(!s||16&o)&&O(e,"--left",t[4]),(!s||32&o)&&O(e,"--top",t[5])},i(t){s||(V(a),s=!0)},o(t){Q(a),s=!1},d(t){t&&w(e),~n&&l[n].d(),o=!1,i()}}}function Va(){window.location.reload()}function Qa(t,e,n){let a,s;u(t,Lt,(t=>n(6,a=t))),u(t,xe,(t=>n(7,s=t)));let o,i,r=!1,l=1,c="0",h="0";return t.$$.update=()=>{if(14&t.$$.dirty){n(3,l=Math.min(o/1920,i/1080));const t=1920*l,e=1080*l;n(4,c=`${Math.floor((o-t)/2)}px`),n(5,h=`${Math.floor((i-e)/2)}px`)}},[r,o,i,l,c,h,a,s,function(){n(0,r=!0)},function(){n(1,o=Ua.innerWidth),n(2,i=Ua.innerHeight)}]}return new class extends st{constructor(t){super(),at(this,t,Qa,Ja,r,{})}}({target:document.body})}();
